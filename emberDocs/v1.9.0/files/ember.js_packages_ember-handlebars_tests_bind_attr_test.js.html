<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>ember.js/packages/ember-handlebars/tests/bind_attr_test.js - The Ember API</title>
    <link rel="stylesheet" href="http://yui.yahooapis.com/3.9.1/build/cssgrids/cssgrids-min.css">
    <link rel="stylesheet" href="../assets/vendor/prettify/prettify-min.css">
    <link rel="stylesheet" href="../assets/css/main.css" id="site_styles">
    <link rel="icon" href="../assets/favicon.ico">
    <script src="http://yui.yahooapis.com/combo?3.9.1/build/yui/yui-min.js"></script>
</head>
<body class="yui3-skin-sam">

<div id="doc">
    <div id="hd" class="yui3-g header">
        <div class="yui3-u-3-4">
                <h1><img src="../assets/css/logo.png" title="The Ember API" width="117" height="52"></h1>
        </div>
        <div class="yui3-u-1-4 version">
            <em>API Docs for: 1.0.0</em>
        </div>
    </div>
    <div id="bd" class="yui3-g">

        <div class="yui3-u-1-4">
            <div id="docs-sidebar" class="sidebar apidocs">
                <div id="api-list">
                    <h2 class="off-left">APIs</h2>
                    <div id="api-tabview" class="tabview">
                        <ul class="tabs">
                            <li><a href="#api-classes">Classes</a></li>
                            <li><a href="#api-modules">Modules</a></li>
                        </ul>
                
                        <div id="api-tabview-filter">
                            <input type="search" id="api-filter" placeholder="Type to filter APIs">
                        </div>
                
                        <div id="api-tabview-panel">
                            <ul id="api-classes" class="apis classes">
                                <li><a href="../classes/A Suite can be used to define a reusable set of unit tests that can be
                applied to any object.  Suites are most useful for defining tests that
                work against a mixin or plugin API.  Developers implementing objects that
                use the mixin or support the API can then run these tests against their
                own code to verify compliance.
                
                To define a suite, you need to define the tests themselves as well as a
                callback API implementors can use to tie your tests to thier specific class.
                
                ## Defining a Callback API
                
                To define the callback API, just extend this class and add your properties
                or methods that must be provided.  Use Ember.required() placeholders for
                any properties that implementors must define themselves.
                
                ## Defining Unit Tests
                
                To add unit tests, use the suite.module() or suite.test() methods instead
                of a regular module() or test() method when defining your tests.  This will
                add the tests to the suite.
                
                ## Using a Suite
                
                To use a Suite to test your own objects, extend the suite subclass and
                define any required methods.  Then call run() on the new subclass.  This
                will create an instance of your class and then defining the unit tests..html">A Suite can be used to define a reusable set of unit tests that can be
                applied to any object.  Suites are most useful for defining tests that
                work against a mixin or plugin API.  Developers implementing objects that
                use the mixin or support the API can then run these tests against their
                own code to verify compliance.
                
                To define a suite, you need to define the tests themselves as well as a
                callback API implementors can use to tie your tests to thier specific class.
                
                ## Defining a Callback API
                
                To define the callback API, just extend this class and add your properties
                or methods that must be provided.  Use Ember.required() placeholders for
                any properties that implementors must define themselves.
                
                ## Defining Unit Tests
                
                To add unit tests, use the suite.module() or suite.test() methods instead
                of a regular module() or test() method when defining your tests.  This will
                add the tests to the suite.
                
                ## Using a Suite
                
                To use a Suite to test your own objects, extend the suite subclass and
                define any required methods.  Then call run() on the new subclass.  This
                will create an instance of your class and then defining the unit tests.</a></li>
                                <li><a href="../classes/Ember.html">Ember</a></li>
                                <li><a href="../classes/Ember._HandlebarsBoundView.html">Ember._HandlebarsBoundView</a></li>
                                <li><a href="../classes/Ember._Metamorph.html">Ember._Metamorph</a></li>
                                <li><a href="../classes/Ember._MetamorphView.html">Ember._MetamorphView</a></li>
                                <li><a href="../classes/Ember._SimpleMetamorphView.html">Ember._SimpleMetamorphView</a></li>
                                <li><a href="../classes/Ember.ActionHandler.html">Ember.ActionHandler</a></li>
                                <li><a href="../classes/Ember.Application.html">Ember.Application</a></li>
                                <li><a href="../classes/Ember.Array.html">Ember.Array</a></li>
                                <li><a href="../classes/Ember.ArrayController.html">Ember.ArrayController</a></li>
                                <li><a href="../classes/Ember.ArrayProxy.html">Ember.ArrayProxy</a></li>
                                <li><a href="../classes/Ember.AutoLocation.html">Ember.AutoLocation</a></li>
                                <li><a href="../classes/Ember.Binding.html">Ember.Binding</a></li>
                                <li><a href="../classes/Ember.Checkbox.html">Ember.Checkbox</a></li>
                                <li><a href="../classes/Ember.CollectionView.html">Ember.CollectionView</a></li>
                                <li><a href="../classes/Ember.Comparable.html">Ember.Comparable</a></li>
                                <li><a href="../classes/Ember.Component.html">Ember.Component</a></li>
                                <li><a href="../classes/Ember.ComponentTemplateDeprecation.html">Ember.ComponentTemplateDeprecation</a></li>
                                <li><a href="../classes/Ember.ComputedProperty.html">Ember.ComputedProperty</a></li>
                                <li><a href="../classes/Ember.ContainerDebugAdapter.html">Ember.ContainerDebugAdapter</a></li>
                                <li><a href="../classes/Ember.ContainerView.html">Ember.ContainerView</a></li>
                                <li><a href="../classes/Ember.Controller.html">Ember.Controller</a></li>
                                <li><a href="../classes/Ember.ControllerContentModelAliasDeprecation.html">Ember.ControllerContentModelAliasDeprecation</a></li>
                                <li><a href="../classes/Ember.ControllerMixin.html">Ember.ControllerMixin</a></li>
                                <li><a href="../classes/Ember.Copyable.html">Ember.Copyable</a></li>
                                <li><a href="../classes/Ember.CoreObject.html">Ember.CoreObject</a></li>
                                <li><a href="../classes/Ember.CoreView.html">Ember.CoreView</a></li>
                                <li><a href="../classes/Ember.DataAdapter.html">Ember.DataAdapter</a></li>
                                <li><a href="../classes/Ember.DefaultResolver.html">Ember.DefaultResolver</a></li>
                                <li><a href="../classes/Ember.Deferred.html">Ember.Deferred</a></li>
                                <li><a href="../classes/Ember.Descriptor.html">Ember.Descriptor</a></li>
                                <li><a href="../classes/Ember.EachProxy.html">Ember.EachProxy</a></li>
                                <li><a href="../classes/Ember.Enumerable.html">Ember.Enumerable</a></li>
                                <li><a href="../classes/Ember.EnumerableUtils.html">Ember.EnumerableUtils</a></li>
                                <li><a href="../classes/Ember.Error.html">Ember.Error</a></li>
                                <li><a href="../classes/Ember.EventDispatcher.html">Ember.EventDispatcher</a></li>
                                <li><a href="../classes/Ember.Evented.html">Ember.Evented</a></li>
                                <li><a href="../classes/Ember.FEATURES.html">Ember.FEATURES</a></li>
                                <li><a href="../classes/Ember.Freezable.html">Ember.Freezable</a></li>
                                <li><a href="../classes/Ember.Handlebars.html">Ember.Handlebars</a></li>
                                <li><a href="../classes/Ember.Handlebars.Compiler.html">Ember.Handlebars.Compiler</a></li>
                                <li><a href="../classes/Ember.Handlebars.helpers.html">Ember.Handlebars.helpers</a></li>
                                <li><a href="../classes/Ember.Handlebars.JavaScriptCompiler.html">Ember.Handlebars.JavaScriptCompiler</a></li>
                                <li><a href="../classes/Ember.HashLocation.html">Ember.HashLocation</a></li>
                                <li><a href="../classes/Ember.HistoryLocation.html">Ember.HistoryLocation</a></li>
                                <li><a href="../classes/Ember.inject.html">Ember.inject</a></li>
                                <li><a href="../classes/Ember.InjectedProperty.html">Ember.InjectedProperty</a></li>
                                <li><a href="../classes/Ember.Instrumentation.html">Ember.Instrumentation</a></li>
                                <li><a href="../classes/Ember.LinkView.html">Ember.LinkView</a></li>
                                <li><a href="../classes/Ember.Location.html">Ember.Location</a></li>
                                <li><a href="../classes/Ember.Logger.html">Ember.Logger</a></li>
                                <li><a href="../classes/Ember.Map.html">Ember.Map</a></li>
                                <li><a href="../classes/Ember.MapWithDefault.html">Ember.MapWithDefault</a></li>
                                <li><a href="../classes/Ember.Mixin.html">Ember.Mixin</a></li>
                                <li><a href="../classes/Ember.MutableArray.html">Ember.MutableArray</a></li>
                                <li><a href="../classes/Ember.MutableEnumerable.html">Ember.MutableEnumerable</a></li>
                                <li><a href="../classes/Ember.Namespace.html">Ember.Namespace</a></li>
                                <li><a href="../classes/Ember.NativeArray.html">Ember.NativeArray</a></li>
                                <li><a href="../classes/Ember.NoneLocation.html">Ember.NoneLocation</a></li>
                                <li><a href="../classes/Ember.Object.html">Ember.Object</a></li>
                                <li><a href="../classes/Ember.ObjectController.html">Ember.ObjectController</a></li>
                                <li><a href="../classes/Ember.ObjectProxy.html">Ember.ObjectProxy</a></li>
                                <li><a href="../classes/Ember.Observable.html">Ember.Observable</a></li>
                                <li><a href="../classes/Ember.OrderedSet.html">Ember.OrderedSet</a></li>
                                <li><a href="../classes/Ember.platform.html">Ember.platform</a></li>
                                <li><a href="../classes/Ember.PromiseProxyMixin.html">Ember.PromiseProxyMixin</a></li>
                                <li><a href="../classes/Ember.ProxyMixin.html">Ember.ProxyMixin</a></li>
                                <li><a href="../classes/Ember.ReduceComputedProperty.html">Ember.ReduceComputedProperty</a></li>
                                <li><a href="../classes/Ember.Route.html">Ember.Route</a></li>
                                <li><a href="../classes/Ember.Router.html">Ember.Router</a></li>
                                <li><a href="../classes/Ember.run.html">Ember.run</a></li>
                                <li><a href="../classes/Ember.Select.html">Ember.Select</a></li>
                                <li><a href="../classes/Ember.Service.html">Ember.Service</a></li>
                                <li><a href="../classes/Ember.Set.html">Ember.Set</a></li>
                                <li><a href="../classes/Ember.SortableMixin.html">Ember.SortableMixin</a></li>
                                <li><a href="../classes/Ember.String.html">Ember.String</a></li>
                                <li><a href="../classes/Ember.SubArray.html">Ember.SubArray</a></li>
                                <li><a href="../classes/Ember.TargetActionSupport.html">Ember.TargetActionSupport</a></li>
                                <li><a href="../classes/Ember.Test.html">Ember.Test</a></li>
                                <li><a href="../classes/Ember.Test.Adapter.html">Ember.Test.Adapter</a></li>
                                <li><a href="../classes/Ember.Test.QUnitAdapter.html">Ember.Test.QUnitAdapter</a></li>
                                <li><a href="../classes/Ember.TextArea.html">Ember.TextArea</a></li>
                                <li><a href="../classes/Ember.TextField.html">Ember.TextField</a></li>
                                <li><a href="../classes/Ember.TextSupport.html">Ember.TextSupport</a></li>
                                <li><a href="../classes/Ember.TrackedArray.html">Ember.TrackedArray</a></li>
                                <li><a href="../classes/Ember.View.html">Ember.View</a></li>
                                <li><a href="../classes/Ember.ViewTargetActionSupport.html">Ember.ViewTargetActionSupport</a></li>
                                <li><a href="../classes/Function.html">Function</a></li>
                                <li><a href="../classes/String.html">String</a></li>
                            </ul>
                
                
                            <ul id="api-modules" class="apis modules">
                                <li><a href="../modules/ember.html">ember</a></li>
                                <li><a href="../modules/ember-application.html">ember-application</a></li>
                                <li><a href="../modules/ember-debug.html">ember-debug</a></li>
                                <li><a href="../modules/ember-extension-support.html">ember-extension-support</a></li>
                                <li><a href="../modules/ember-handlebars.html">ember-handlebars</a></li>
                                <li><a href="../modules/ember-handlebars-compiler.html">ember-handlebars-compiler</a></li>
                                <li><a href="../modules/ember-metal.html">ember-metal</a></li>
                                <li><a href="../modules/ember-routing.html">ember-routing</a></li>
                                <li><a href="../modules/ember-routing-handlebars.html">ember-routing-handlebars</a></li>
                                <li><a href="../modules/ember-runtime.html">ember-runtime</a></li>
                                <li><a href="../modules/ember-testing.html">ember-testing</a></li>
                                <li><a href="../modules/ember-views.html">ember-views</a></li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="yui3-u-3-4">
                <div id="api-options">
                    Show:
                    <label for="api-show-inherited">
                        <input type="checkbox" id="api-show-inherited" checked>
                        Inherited
                    </label>
            
                    <label for="api-show-protected">
                        <input type="checkbox" id="api-show-protected">
                        Protected
                    </label>
            
                    <label for="api-show-private">
                        <input type="checkbox" id="api-show-private">
                        Private
                    </label>
                    <label for="api-show-deprecated">
                        <input type="checkbox" id="api-show-deprecated">
                        Deprecated
                    </label>
            
                </div>
            
            <div class="apidocs">
                <div id="docs-main">
                    <div class="content">
<h1 class="file-heading">File: ember.js/packages/ember-handlebars/tests/bind_attr_test.js</h1>

<div class="file">
    <pre class="code prettyprint linenums">
/*jshint newcap:false*/
import Ember from &quot;ember-metal/core&quot;; // Ember.lookup
import run from &quot;ember-metal/run_loop&quot;;
import Namespace from &quot;ember-runtime/system/namespace&quot;;
import EmberView from &quot;ember-views/views/view&quot;;
import _MetamorphView from &quot;ember-handlebars/views/metamorph_view&quot;;
import EmberHandlebars from &quot;ember-handlebars&quot;;
import EmberObject from &quot;ember-runtime/system/object&quot;;
import { A } from &quot;ember-runtime/system/native_array&quot;;
import { computed } from &quot;ember-metal/computed&quot;;
import { observersFor } from &quot;ember-metal/observer&quot;;
import Container from &quot;ember-runtime/system/container&quot;;
import { set } from &quot;ember-metal/property_set&quot;;

var view;

var appendView = function() {
  run(function() { view.appendTo(&#x27;#qunit-fixture&#x27;); });
};

var originalLookup = Ember.lookup;
var TemplateTests, container, lookup;

/**
  This module specifically tests integration with Handlebars and Ember-specific
  Handlebars extensions.

  If you add additional template support to View, you should create a new
  file in which to test.
*/
QUnit.module(&quot;View - handlebars integration&quot;, {
  setup: function() {
    Ember.lookup = lookup = {};
    lookup.TemplateTests = TemplateTests = Namespace.create();
    container = new Container();
    container.optionsForType(&#x27;template&#x27;, { instantiate: false });
    container.register(&#x27;view:default&#x27;, _MetamorphView);
    container.register(&#x27;view:toplevel&#x27;, EmberView.extend());
  },

  teardown: function() {
    run(function() {
        if (container) {
          container.destroy();
        }
        if (view) {
          view.destroy();
        }
        container = view = null;
    });
    Ember.lookup = lookup = originalLookup;
    TemplateTests = null;
  }
});

test(&quot;should be able to bind element attributes using {{bind-attr}}&quot;, function() {
  var template = EmberHandlebars.compile(&#x27;&lt;img {{bind-attr src=&quot;view.content.url&quot; alt=&quot;view.content.title&quot;}}&gt;&#x27;);

  view = EmberView.create({
    template: template,
    content: EmberObject.create({
      url: &quot;http://www.emberjs.com/assets/images/logo.png&quot;,
      title: &quot;The SproutCore Logo&quot;
    })
  });

  appendView();

  equal(view.$(&#x27;img&#x27;).attr(&#x27;src&#x27;), &quot;http://www.emberjs.com/assets/images/logo.png&quot;, &quot;sets src attribute&quot;);
  equal(view.$(&#x27;img&#x27;).attr(&#x27;alt&#x27;), &quot;The SproutCore Logo&quot;, &quot;sets alt attribute&quot;);

  run(function() {
    set(view, &#x27;content.title&#x27;, &quot;El logo de Eember&quot;);
  });

  equal(view.$(&#x27;img&#x27;).attr(&#x27;alt&#x27;), &quot;El logo de Eember&quot;, &quot;updates alt attribute when content&#x27;s title attribute changes&quot;);

  run(function() {
    set(view, &#x27;content&#x27;, EmberObject.create({
      url: &quot;http://www.thegooglez.com/theydonnothing&quot;,
      title: &quot;I CAN HAZ SEARCH&quot;
    }));
  });

  equal(view.$(&#x27;img&#x27;).attr(&#x27;alt&#x27;), &quot;I CAN HAZ SEARCH&quot;, &quot;updates alt attribute when content object changes&quot;);

  run(function() {
    set(view, &#x27;content&#x27;, {
      url: &quot;http://www.emberjs.com/assets/images/logo.png&quot;,
      title: &quot;The SproutCore Logo&quot;
    });
  });

  equal(view.$(&#x27;img&#x27;).attr(&#x27;alt&#x27;), &quot;The SproutCore Logo&quot;, &quot;updates alt attribute when content object is a hash&quot;);

  run(function() {
    set(view, &#x27;content&#x27;, EmberObject.createWithMixins({
      url: &quot;http://www.emberjs.com/assets/images/logo.png&quot;,
      title: computed(function() {
        return &quot;Nanananana Ember!&quot;;
      })
    }));
  });

  equal(view.$(&#x27;img&#x27;).attr(&#x27;alt&#x27;), &quot;Nanananana Ember!&quot;, &quot;updates alt attribute when title property is computed&quot;);
});

test(&quot;should be able to bind to view attributes with {{bind-attr}}&quot;, function() {
  view = EmberView.create({
    value: &#x27;Test&#x27;,
    template: EmberHandlebars.compile(&#x27;&lt;img src=&quot;test.jpg&quot; {{bind-attr alt=&quot;view.value&quot;}}&gt;&#x27;)
  });

  appendView();

  equal(view.$(&#x27;img&#x27;).attr(&#x27;alt&#x27;), &quot;Test&quot;, &quot;renders initial value&quot;);

  run(function() {
    view.set(&#x27;value&#x27;, &#x27;Updated&#x27;);
  });

  equal(view.$(&#x27;img&#x27;).attr(&#x27;alt&#x27;), &quot;Updated&quot;, &quot;updates value&quot;);
});

test(&quot;should be able to bind to globals with {{bind-attr}} (DEPRECATED)&quot;, function() {
  TemplateTests.set(&#x27;value&#x27;, &#x27;Test&#x27;);

  view = EmberView.create({
    template: EmberHandlebars.compile(&#x27;&lt;img src=&quot;test.jpg&quot; {{bind-attr alt=&quot;TemplateTests.value&quot;}}&gt;&#x27;)
  });

  expectDeprecation(function(){
    appendView();
  }, /Global lookup of TemplateTests.value from a Handlebars template is deprecated/);

  equal(view.$(&#x27;img&#x27;).attr(&#x27;alt&#x27;), &quot;Test&quot;, &quot;renders initial value&quot;);
});

test(&quot;should not allow XSS injection via {{bind-attr}}&quot;, function() {
  view = EmberView.create({
    template: EmberHandlebars.compile(&#x27;&lt;img src=&quot;test.jpg&quot; {{bind-attr alt=&quot;view.content.value&quot;}}&gt;&#x27;),
    content: {
      value: &#x27;Trololol&quot; onmouseover=&quot;alert(\&#x27;HAX!\&#x27;);&#x27;
    }
  });

  appendView();

  equal(view.$(&#x27;img&#x27;).attr(&#x27;onmouseover&#x27;), undefined);
  // If the whole string is here, then it means we got properly escaped
  equal(view.$(&#x27;img&#x27;).attr(&#x27;alt&#x27;), &#x27;Trololol&quot; onmouseover=&quot;alert(\&#x27;HAX!\&#x27;);&#x27;);
});

test(&quot;should be able to bind use {{bind-attr}} more than once on an element&quot;, function() {
  var template = EmberHandlebars.compile(&#x27;&lt;img {{bind-attr src=&quot;view.content.url&quot;}} {{bind-attr alt=&quot;view.content.title&quot;}}&gt;&#x27;);

  view = EmberView.create({
    template: template,
    content: EmberObject.create({
      url: &quot;http://www.emberjs.com/assets/images/logo.png&quot;,
      title: &quot;The SproutCore Logo&quot;
    })
  });

  appendView();

  equal(view.$(&#x27;img&#x27;).attr(&#x27;src&#x27;), &quot;http://www.emberjs.com/assets/images/logo.png&quot;, &quot;sets src attribute&quot;);
  equal(view.$(&#x27;img&#x27;).attr(&#x27;alt&#x27;), &quot;The SproutCore Logo&quot;, &quot;sets alt attribute&quot;);

  run(function() {
    set(view, &#x27;content.title&#x27;, &quot;El logo de Eember&quot;);
  });

  equal(view.$(&#x27;img&#x27;).attr(&#x27;alt&#x27;), &quot;El logo de Eember&quot;, &quot;updates alt attribute when content&#x27;s title attribute changes&quot;);

  run(function() {
    set(view, &#x27;content&#x27;, EmberObject.create({
      url: &quot;http://www.thegooglez.com/theydonnothing&quot;,
      title: &quot;I CAN HAZ SEARCH&quot;
    }));
  });

  equal(view.$(&#x27;img&#x27;).attr(&#x27;alt&#x27;), &quot;I CAN HAZ SEARCH&quot;, &quot;updates alt attribute when content object changes&quot;);

  run(function() {
    set(view, &#x27;content&#x27;, {
      url: &quot;http://www.emberjs.com/assets/images/logo.png&quot;,
      title: &quot;The SproutCore Logo&quot;
    });
  });

  equal(view.$(&#x27;img&#x27;).attr(&#x27;alt&#x27;), &quot;The SproutCore Logo&quot;, &quot;updates alt attribute when content object is a hash&quot;);

  run(function() {
    set(view, &#x27;content&#x27;, EmberObject.createWithMixins({
      url: &quot;http://www.emberjs.com/assets/images/logo.png&quot;,
      title: computed(function() {
        return &quot;Nanananana Ember!&quot;;
      })
    }));
  });

  equal(view.$(&#x27;img&#x27;).attr(&#x27;alt&#x27;), &quot;Nanananana Ember!&quot;, &quot;updates alt attribute when title property is computed&quot;);

});

test(&quot;{{bindAttr}} is aliased to {{bind-attr}}&quot;, function() {
  expect(4);

  var originalBindAttr = EmberHandlebars.helpers[&#x27;bind-attr&#x27;];

  try {
    EmberHandlebars.helpers[&#x27;bind-attr&#x27;] = function() {
      equal(arguments[0], &#x27;foo&#x27;, &#x27;First arg match&#x27;);
      equal(arguments[1], &#x27;bar&#x27;, &#x27;Second arg match&#x27;);

      return &#x27;result&#x27;;
    };

    expectDeprecation(function() {
      var result = EmberHandlebars.helpers.bindAttr(&#x27;foo&#x27;, &#x27;bar&#x27;);
      equal(result, &#x27;result&#x27;, &#x27;Result match&#x27;);
    }, &quot;The &#x27;bindAttr&#x27; view helper is deprecated in favor of &#x27;bind-attr&#x27;&quot;);
  } finally {
    EmberHandlebars.helpers[&#x27;bind-attr&#x27;] = originalBindAttr;
  }
});

test(&quot;should be able to bind element attributes using {{bind-attr}} inside a block&quot;, function() {
  var template = EmberHandlebars.compile(&#x27;{{#with view.content as image}}&lt;img {{bind-attr src=image.url alt=image.title}}&gt;{{/with}}&#x27;);

  view = EmberView.create({
    template: template,
    content: EmberObject.create({
      url: &quot;http://www.emberjs.com/assets/images/logo.png&quot;,
      title: &quot;The SproutCore Logo&quot;
    })
  });

  appendView();

  equal(view.$(&#x27;img&#x27;).attr(&#x27;src&#x27;), &quot;http://www.emberjs.com/assets/images/logo.png&quot;, &quot;sets src attribute&quot;);
  equal(view.$(&#x27;img&#x27;).attr(&#x27;alt&#x27;), &quot;The SproutCore Logo&quot;, &quot;sets alt attribute&quot;);

  run(function() {
    set(view, &#x27;content.title&#x27;, &quot;El logo de Eember&quot;);
  });

  equal(view.$(&#x27;img&#x27;).attr(&#x27;alt&#x27;), &quot;El logo de Eember&quot;, &quot;updates alt attribute when content&#x27;s title attribute changes&quot;);
});

test(&quot;should be able to bind class attribute with {{bind-attr}}&quot;, function() {
  var template = EmberHandlebars.compile(&#x27;&lt;img {{bind-attr class=&quot;view.foo&quot;}}&gt;&#x27;);

  view = EmberView.create({
    template: template,
    foo: &#x27;bar&#x27;
  });

  appendView();

  equal(view.$(&#x27;img&#x27;).attr(&#x27;class&#x27;), &#x27;bar&#x27;, &quot;renders class&quot;);

  run(function() {
    set(view, &#x27;foo&#x27;, &#x27;baz&#x27;);
  });

  equal(view.$(&#x27;img&#x27;).attr(&#x27;class&#x27;), &#x27;baz&#x27;, &quot;updates class&quot;);
});

test(&quot;should be able to bind class attribute via a truthy property with {{bind-attr}}&quot;, function() {
  var template = EmberHandlebars.compile(&#x27;&lt;img {{bind-attr class=&quot;view.isNumber:is-truthy&quot;}}&gt;&#x27;);

  view = EmberView.create({
    template: template,
    isNumber: 5
  });

  appendView();

  equal(view.$(&#x27;.is-truthy&#x27;).length, 1, &quot;sets class name&quot;);

  run(function() {
    set(view, &#x27;isNumber&#x27;, 0);
  });

  equal(view.$(&#x27;.is-truthy&#x27;).length, 0, &quot;removes class name if bound property is set to something non-truthy&quot;);
});

test(&quot;should be able to bind class to view attribute with {{bind-attr}}&quot;, function() {
  var template = EmberHandlebars.compile(&#x27;&lt;img {{bind-attr class=&quot;view.foo&quot;}}&gt;&#x27;);

  view = EmberView.create({
    template: template,
    foo: &#x27;bar&#x27;
  });

  appendView();

  equal(view.$(&#x27;img&#x27;).attr(&#x27;class&#x27;), &#x27;bar&#x27;, &quot;renders class&quot;);

  run(function() {
    set(view, &#x27;foo&#x27;, &#x27;baz&#x27;);
  });

  equal(view.$(&#x27;img&#x27;).attr(&#x27;class&#x27;), &#x27;baz&#x27;, &quot;updates class&quot;);
});

test(&quot;should not allow XSS injection via {{bind-attr}} with class&quot;, function() {
  view = EmberView.create({
    template: EmberHandlebars.compile(&#x27;&lt;img {{bind-attr class=&quot;view.foo&quot;}}&gt;&#x27;),
    foo: &#x27;&quot; onmouseover=&quot;alert(\&#x27;I am in your classes hacking your app\&#x27;);&#x27;
  });

  appendView();

  equal(view.$(&#x27;img&#x27;).attr(&#x27;onmouseover&#x27;), undefined);
  // If the whole string is here, then it means we got properly escaped
  equal(view.$(&#x27;img&#x27;).attr(&#x27;class&#x27;), &#x27;&quot; onmouseover=&quot;alert(\&#x27;I am in your classes hacking your app\&#x27;);&#x27;);
});

test(&quot;should be able to bind class attribute using ternary operator in {{bind-attr}}&quot;, function() {
  var template = EmberHandlebars.compile(&#x27;&lt;img {{bind-attr class=&quot;view.content.isDisabled:disabled:enabled&quot;}} /&gt;&#x27;);
  var content = EmberObject.create({
    isDisabled: true
  });

  view = EmberView.create({
    template: template,
    content: content
  });

  appendView();

  ok(view.$(&#x27;img&#x27;).hasClass(&#x27;disabled&#x27;), &#x27;disabled class is rendered&#x27;);
  ok(!view.$(&#x27;img&#x27;).hasClass(&#x27;enabled&#x27;), &#x27;enabled class is not rendered&#x27;);

  run(function() {
    set(content, &#x27;isDisabled&#x27;, false);
  });

  ok(!view.$(&#x27;img&#x27;).hasClass(&#x27;disabled&#x27;), &#x27;disabled class is not rendered&#x27;);
  ok(view.$(&#x27;img&#x27;).hasClass(&#x27;enabled&#x27;), &#x27;enabled class is rendered&#x27;);
});

test(&quot;should be able to add multiple classes using {{bind-attr class}}&quot;, function() {
  var template = EmberHandlebars.compile(&#x27;&lt;div {{bind-attr class=&quot;view.content.isAwesomeSauce view.content.isAlsoCool view.content.isAmazing:amazing :is-super-duper view.content.isEnabled:enabled:disabled&quot;}}&gt;&lt;/div&gt;&#x27;);
  var content = EmberObject.create({
    isAwesomeSauce: true,
    isAlsoCool: true,
    isAmazing: true,
    isEnabled: true
  });

  view = EmberView.create({
    template: template,
    content: content
  });

  appendView();

  ok(view.$(&#x27;div&#x27;).hasClass(&#x27;is-awesome-sauce&#x27;), &quot;dasherizes first property and sets classname&quot;);
  ok(view.$(&#x27;div&#x27;).hasClass(&#x27;is-also-cool&#x27;), &quot;dasherizes second property and sets classname&quot;);
  ok(view.$(&#x27;div&#x27;).hasClass(&#x27;amazing&#x27;), &quot;uses alias for third property and sets classname&quot;);
  ok(view.$(&#x27;div&#x27;).hasClass(&#x27;is-super-duper&#x27;), &quot;static class is present&quot;);
  ok(view.$(&#x27;div&#x27;).hasClass(&#x27;enabled&#x27;), &quot;truthy class in ternary classname definition is rendered&quot;);
  ok(!view.$(&#x27;div&#x27;).hasClass(&#x27;disabled&#x27;), &quot;falsy class in ternary classname definition is not rendered&quot;);

  run(function() {
    set(content, &#x27;isAwesomeSauce&#x27;, false);
    set(content, &#x27;isAmazing&#x27;, false);
    set(content, &#x27;isEnabled&#x27;, false);
  });

  ok(!view.$(&#x27;div&#x27;).hasClass(&#x27;is-awesome-sauce&#x27;), &quot;removes dasherized class when property is set to false&quot;);
  ok(!view.$(&#x27;div&#x27;).hasClass(&#x27;amazing&#x27;), &quot;removes aliased class when property is set to false&quot;);
  ok(view.$(&#x27;div&#x27;).hasClass(&#x27;is-super-duper&#x27;), &quot;static class is still present&quot;);
  ok(!view.$(&#x27;div&#x27;).hasClass(&#x27;enabled&#x27;), &quot;truthy class in ternary classname definition is not rendered&quot;);
  ok(view.$(&#x27;div&#x27;).hasClass(&#x27;disabled&#x27;), &quot;falsy class in ternary classname definition is rendered&quot;);
});

test(&quot;should be able to bind classes to globals with {{bind-attr class}} (DEPRECATED)&quot;, function() {
  TemplateTests.set(&#x27;isOpen&#x27;, true);

  view = EmberView.create({
    template: EmberHandlebars.compile(&#x27;&lt;img src=&quot;test.jpg&quot; {{bind-attr class=&quot;TemplateTests.isOpen&quot;}}&gt;&#x27;)
  });

  expectDeprecation(function(){
    appendView();
  }, /Global lookup of TemplateTests.isOpen from a Handlebars template is deprecated/);

  ok(view.$(&#x27;img&#x27;).hasClass(&#x27;is-open&#x27;), &quot;sets classname to the dasherized value of the global property&quot;);
});

test(&quot;should be able to bind-attr to &#x27;this&#x27; in an {{#each}} block [DEPRECATED]&quot;, function() {
  expectDeprecation(&#x27;Using the context switching form of {{each}} is deprecated. Please use the keyword form (&#x60;{{#each foo in bar}}&#x60;) instead. See http://emberjs.com/guides/deprecations/#toc_more-consistent-handlebars-scope for more details.&#x27;);

  view = EmberView.create({
    template: EmberHandlebars.compile(&#x27;{{#each view.images}}&lt;img {{bind-attr src=&quot;this&quot;}}&gt;{{/each}}&#x27;),
    images: A([&#x27;one.png&#x27;, &#x27;two.jpg&#x27;, &#x27;three.gif&#x27;])
  });

  appendView();

  var images = view.$(&#x27;img&#x27;);
  ok(/one\.png$/.test(images[0].src));
  ok(/two\.jpg$/.test(images[1].src));
  ok(/three\.gif$/.test(images[2].src));
});

test(&quot;should be able to bind classes to &#x27;this&#x27; in an {{#each}} block with {{bind-attr class}} [DEPRECATED]&quot;, function() {
  expectDeprecation(&#x27;Using the context switching form of {{each}} is deprecated. Please use the keyword form (&#x60;{{#each foo in bar}}&#x60;) instead. See http://emberjs.com/guides/deprecations/#toc_more-consistent-handlebars-scope for more details.&#x27;);

  view = EmberView.create({
    template: EmberHandlebars.compile(&#x27;{{#each view.items}}&lt;li {{bind-attr class=&quot;this&quot;}}&gt;Item&lt;/li&gt;{{/each}}&#x27;),
    items: A([&#x27;a&#x27;, &#x27;b&#x27;, &#x27;c&#x27;])
  });

  appendView();

  ok(view.$(&#x27;li&#x27;).eq(0).hasClass(&#x27;a&#x27;), &quot;sets classname to the value of the first item&quot;);
  ok(view.$(&#x27;li&#x27;).eq(1).hasClass(&#x27;b&#x27;), &quot;sets classname to the value of the second item&quot;);
  ok(view.$(&#x27;li&#x27;).eq(2).hasClass(&#x27;c&#x27;), &quot;sets classname to the value of the third item&quot;);
});

test(&quot;should be able to bind-attr to var in {{#each var in list}} block&quot;, function() {
  view = EmberView.create({
    template: EmberHandlebars.compile(&#x27;{{#each image in view.images}}&lt;img {{bind-attr src=&quot;image&quot;}}&gt;{{/each}}&#x27;),
    images: A([&#x27;one.png&#x27;, &#x27;two.jpg&#x27;, &#x27;three.gif&#x27;])
  });

  appendView();

  var images = view.$(&#x27;img&#x27;);
  ok(/one\.png$/.test(images[0].src));
  ok(/two\.jpg$/.test(images[1].src));
  ok(/three\.gif$/.test(images[2].src));

  run(function() {
    var imagesArray = view.get(&#x27;images&#x27;);
    imagesArray.removeAt(0);
  });

  images = view.$(&#x27;img&#x27;);
  ok(images.length === 2, &quot;&quot;);
  ok(/two\.jpg$/.test(images[0].src));
  ok(/three\.gif$/.test(images[1].src));
});

test(&quot;should teardown observers from bind-attr on rerender&quot;, function() {
  view = EmberView.create({
    template: EmberHandlebars.compile(&#x27;&lt;span {{bind-attr class=&quot;view.foo&quot; name=&quot;view.foo&quot;}}&gt;wat&lt;/span&gt;&#x27;),
    foo: &#x27;bar&#x27;
  });

  appendView();

  equal(observersFor(view, &#x27;foo&#x27;).length, 1);

  run(function() {
    view.rerender();
  });

  equal(observersFor(view, &#x27;foo&#x27;).length, 1);
});

    </pre>
</div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<script src="../assets/vendor/prettify/prettify-min.js"></script>
<script>prettyPrint();</script>
<script src="../assets/js/yui-prettify.js"></script>
<script src="../assets/../api.js"></script>
<script src="../assets/js/api-filter.js"></script>
<script src="../assets/js/api-list.js"></script>
<script src="../assets/js/api-search.js"></script>
<script src="../assets/js/apidocs.js"></script>
</body>
</html>
